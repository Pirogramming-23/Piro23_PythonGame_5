import random
import time
from game_like import play as game1
from game_bs31 import play as game2
from game_sblike import play as game3
from game_bs31 import play as game4

# ê²Œì„ ë¦¬ìŠ¤íŠ¸
game_list = [
    ("ì¢‹ì•„ ê²Œì„", game1),
    ("369 ê²Œì„", game2),
    ("ë”¸ê¸° ê²Œì„", game3),
    ("ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ 31 ê²Œì„", game4),
]

# ê²Œì„ ì¸íŠ¸ë¡œ
def show_intro():
    intro_art = r"""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                ___    __    __________  __  ______  __       _________    __  _________
               /   |  / /   / ____/ __ \/ / / / __ \/ /      / ____/   |  /  |/  / ____/
              / /| | / /   / /   / / / / /_/ / / / / /      / / __/ /| | / /|_/ / __/   
             / ___ |/ /___/ /___/ /_/ / __  / /_/ / /___   / /_/ / ___ |/ /  / / /___   
            /_/  |_/_____/\____/\____/_/ /_/\____/_____/   \____/_/  |_/_/  /_/_____/   
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ï¸µ(â‰§oâ‰¦)ï¸µ ï¸µ(â‰§oâ‰¦)ï¸µ  ì•ˆì£¼ ë¨¹ì„ğŸ— ì‹œê°„ì´â° ì—†ì–´ìš”âŒ ë§ˆì‹œë©´ì„œ ë°°ìš°ëŠ” ìˆ ê²Œì„ğŸºğŸ» ï¸µ(â‰§oâ‰¦)ï¸µ ï¸µ(â‰§oâ‰¦)ï¸µ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"""
    print(intro_art)
    
    while True:
        answer = input("ê²Œì„ì„ ì§„í–‰í• ê¹Œìš”? (y/n): ").strip().lower()
        if answer == "y":
            print("\nê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤!\n")
            return True
        elif answer == "n":
            print("ê²Œì„ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ë‹¤ìŒì— ë˜ ë§Œë‚˜ìš”!")
            return False
        else:
            print("âš ï¸ y ë˜ëŠ” nìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.")

# ì‚¬ìš©ì ì´ë¦„ ë°›ê¸°
def get_player_name():
    name = input("ğŸŒŸ ì˜¤ëŠ˜ ê±°í•˜ê²Œ ì·¨í•´ë³¼ ë‹¹ì‹ ì˜ ì´ë¦„ì€? : ").strip()
    while not name:
        print("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!")
        name = input("ğŸŒŸ ì˜¤ëŠ˜ ê±°í•˜ê²Œ ì·¨í•´ë³¼ ë‹¹ì‹ ì˜ ì´ë¦„ì€? : ").strip()
    print(f"\në°˜ê°€ì›Œìš”, {name}ë‹˜! ğŸ¥³")
    return name

# ì£¼ëŸ‰ ì„ íƒ
def select_drink_limit():
    temp = r"""
~~~~~~~~~~~~~~~~~~~~~~~~~~~ğŸº ì†Œì£¼ ê¸°ì¤€ ë‹¹ì‹ ì˜ ì£¼ëŸ‰ì€? ğŸº~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            ğŸº 1. ì†Œì£¼ ë°˜ë³‘ (2ì”)
                            ğŸº 2. ì†Œì£¼ ë°˜ë³‘ì—ì„œ í•œë³‘ (4ì”)
                            ğŸº 3. ì†Œì£¼ í•œë³‘ì—ì„œ í•œë³‘ ë°˜ (6ì”)
                            ğŸº 4. ì†Œì£¼ í•œë³‘ ë°˜ì—ì„œ ë‘ë³‘ (8ì”)
                            ğŸº 5. ì†Œì£¼ ë‘ë³‘ ì´ìƒ (10ì”)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"""
    print(temp)

    while True:
        choice = input("ë‹¹ì‹ ì˜ ì¹˜ì‚¬ëŸ‰(ì£¼ëŸ‰)ì€ ì–¼ë§ˆë§Œí¼ì¸ê°€ìš”? (1~5ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”) : ").strip()
        if choice not in ['1', '2', '3', '4', '5']:
            print("âš ï¸ 1ë¶€í„° 5 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!\n")
            continue
        choice = int(choice)
        drink_amount = {1: 2, 2: 4, 3: 6, 4: 8, 5: 10}[choice]
        print(f"\nğŸº ë‹¹ì‹ ì˜ ì£¼ëŸ‰ì€ {drink_amount}ì”ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸº\n")
        break
    return drink_amount

# ì¹œêµ¬ ì´ˆëŒ€
def invite_friends(player_name, player_limit):
    participants = [{
        "name": player_name,
        "limit": player_limit,
        "drank": 0
    }]

    names = {"ì€ì„œ": 2, "í•˜ì—°": 4, "ì—°ì„œ": 6, "ì˜ˆì§„": 8, "í˜„ë„": 10}

    if player_name in names:
        del names[player_name]

    while True:
        try:
            count = int(input("í•¨ê»˜ ì·¨í•  ì¹œêµ¬ë“¤ì€ ì–¼ë§ˆë‚˜ í•„ìš”í•˜ì‹ ê°€ìš”? (ìµœëŒ€ 3ëª…ê¹Œì§€ ì´ˆëŒ€í•  ìˆ˜ ìˆì–´ìš”!) : "))
            if 1 <= count <= 3:
                break
            else:
                print("âš ï¸ 1ëª…ì—ì„œ 3ëª… ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”!\n")
        except ValueError:
            print("âš ï¸ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!\n")

    friends = random.sample(list(names.items()), count)
    for name, limit in friends:
        participants.append({
            "name": name,
            "limit": limit,
            "drank": 0
        })
        print(f"ì˜¤ëŠ˜ í•¨ê»˜ ì·¨í•  ì¹œêµ¬ëŠ” {name}ì…ë‹ˆë‹¤! (ì¹˜ì‚¬ëŸ‰: {limit})")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    
    for p in participants:
        print(f"{p['name']}ì€(ëŠ”) ì§€ê¸ˆê¹Œì§€ {p['drank']}ğŸº! ì¹˜ì‚¬ëŸ‰ê¹Œì§€ {p['limit'] - p['drank']}")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    return participants

# ê²Œì„ ì§„í–‰ ë¼ìš´ë“œ
def play_game_round(participants, my_name):
    for player in participants:
        temp = r"""
~~~~~~~~~~~~~~~~~~~~~~~~~~~ğŸº ì˜¤ëŠ˜ì˜ Alcohol Game ğŸº~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                            ğŸº 1. {}
                            ğŸº 2. {}
                            ğŸº 3. {}
                            ğŸº 4. {}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
""".format(game_list[0][0], game_list[1][0], game_list[2][0], game_list[3][0])
        print(temp)

        if player['name'] == my_name:
            # ë‚´ í„´ì´ë©´ ì§ì ‘ ì…ë ¥
            while True:
                try:
                    choice = int(input(f"{player['name']} (ì´)ê°€ ì¢‹ì•„í•˜ëŠ” ëœë¤ ê²Œì„ ~ ëœë¤ ê²Œì„ ~ ë¬´ìŠ¨ ê²Œì„ ? : "))
                    if 1 <= choice <= len(game_list):
                        print(f"{player['name']} ë‹˜ì´ ì„ íƒí•œ ê²Œì„ ë²ˆí˜¸ : {choice} - {game_list[choice - 1][0]}")
                        print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
                        break
                    else:
                        print("âš ï¸ ì˜¬ë°”ë¥¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                except ValueError:
                    print("âš ï¸ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        else:
            # AI í„´ â†’ ëœë¤ ì„ íƒ + ì¶œë ¥
            answer = input(f"ìˆ ê²Œì„ ì§„í–‰ì¤‘! {player['name']}ì˜ í„´ì…ë‹ˆë‹¤. ê·¸ë§Œí•˜ë ¤ë©´ 'exit', ê³„ì†í•˜ë ¤ë©´ ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ì£¼ì„¸ìš”! : ").strip().lower()
            if answer == 'exit':
                print("ê²Œì„ì„ ì¢…ë£Œí•©ë‹ˆë‹¤!")
                exit()

            choice = random.randint(1, len(game_list))
            print(f"\nğŸ² {player['name']} (ì´)ê°€ ê²Œì„ì„ ì„ íƒ ì¤‘...")
            time.sleep(1)
            print(f"{player['name']} (ì´)ê°€ ì„ íƒí•œ ê²Œì„ ë²ˆí˜¸ : {choice} - {game_list[choice - 1][0]}")
            print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")

        _, game_func = game_list[choice - 1]
        drinker_name = game_func(player['name'], participants)

        # ê²°ê³¼ ë°˜ì˜
        for p in participants:
            if p["name"] == drinker_name:
                p["drank"] += 1
        show_status(participants)

        for p in participants:
            if p['drank'] >= p['limit']:
                game_over(p['name'])
                exit()

# ìƒíƒœ ì¶œë ¥
def show_status(participants):
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    for p in participants:
        print(f"{p['name']}ì€(ëŠ”) ì§€ê¸ˆê¹Œì§€ {p['drank']}ğŸº! ì¹˜ì‚¬ëŸ‰ê¹Œì§€ {p['limit'] - p['drank']}")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")

# ê²Œì„ ì¢…ë£Œ
def game_over(name):
    print("--------------------------------------------------------------------------------------------")
    print("--------------------------------------------------------------------------------------------")
    print(r"""
              _____          __  __ ______    ______      ________ _____  
             / ____|   /\   |  \/  |  ____|  / __ \ \    / /  ____|  __ \ 
            | |  __   /  \  | \  / | |__    | |  | \ \  / /| |__  | |__) |
            | | |_ | / /\ \ | |\/| |  __|   | |  | |\ \/ / |  __| |  _  / 
            | |__| |/ ____ \| |  | | |____  | |__| | \  /  | |____| | \ \ 
             \_____/_/    \_\_|  |_|______|  \____/   \/   |______|_|  \_\
""")
    print("--------------------------------------------------------------------------------------------")
    print(f"{name}ì´(ê°€) ì „ì‚¬í–ˆìŠµë‹ˆë‹¤... ê¿ˆë‚˜ë¼ì—ì„œëŠ” í¸íˆ ì‰¬ì‹œê¸¸..zzz\n")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("\t\t\tğŸº ë‹¤ìŒì— ìˆ  ë§ˆì‹œë©´ ë˜ ë¶ˆëŸ¬ì£¼ì„¸ìš”~ ì•ˆë…•! ğŸº")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    exit()

# ë©”ì¸ ì‹¤í–‰
if __name__ == "__main__":
    if show_intro():
        name = get_player_name()
        limit = select_drink_limit()
        participants = invite_friends(name, limit)
        while True:
            play_game_round(participants, name)
    else:
        exit()
